import model                from '../model'

import comparePassword      from './comparePassword'

export default async (payload) => {
  try {
    const { username, password } = payload
    const user = await model.findOne({ where: { username }})

    if (!user) return false

    const passwordHash = user.get(`password`)

    if (await comparePassword({ password, passwordHash })) {
      return user
    }
    throw new Error(`Password not match`)
  } catch (err) {
    throw err
  }
}

import Promise              from 'bluebird'
import nodemailer           from 'nodemailer'

let transport
try {
  transport = nodemailer.createTransport(process.env.REACT_APP_EMAIL_TRANSPORT)
} catch (err) {
  console.log(err)
}

const FROM = process.env.REACT_APP_EMAIL_FROM

export default ({ from = FROM, to, subject, html }) => {
  return new Promise((resolve, reject) => {
    var options = { from, to, subject, html }

    transport && transport.sendMail(options, (err, info) => {
      if (err) {
        return reject(err)
      }
      return resolve(info.response)
    }) || reject(`Transport not initialized`)
  })
}

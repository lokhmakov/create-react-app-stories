import _                    from 'lodash'
import { graphql }          from 'react-apollo'

import generateQueryDelete  from 'engine/graphql/generate/query/delete'

export default ({ config, debug, methods }) => (payload) => {
  // const { options = {} } = payload || {}
  return graphql(generateQueryDelete(config), {
    props: ({ mutate }) => ({
      [methods.delete]: ({ id }) => mutate({
        variables: { id },
        updateQueries: {
          [methods.findAll]: (prev) => ({[methods.findAll]: _.filter(prev[methods.findAll], doc => doc.id != id)})
        },
      }),
    }),
  })
}

import _                    from 'lodash'
import typeMap              from '../typeMap'

export default function generateType(payload) {
  const { name, fieldList, extraFieldList = [] } = payload
  const list = [
    ...fieldList,
    {
      name: `createdAt`,
      type: typeMap.Date,
    },
    {
      name: `updatedAt`,
      type: typeMap.Date,
    }
  ]
  const typeName = _.upperFirst(name)
  return [
    `type ${ typeName } {`,
    list.map(({ name, type }) => {
      if (!typeMap[type]) {
        const fieldName = `${ name }Id`
        return [
          `  ${ _.upperFirst(name) }: ${ _.upperFirst(type) }`,
          `  ${ fieldName }: ID`,
        ].join('\n')
      }

      return `  ${ name }: ${ typeMap[type] }`
    }).join(`\n`),
    extraFieldList.map(({ name, type }) => {
      return `  ${ name }: ${ type }`
    }).join(`\n`),
    `}`,
  ].join('\n')
}

import gql                  from 'graphql-tag'

import generateVarString    from 'engine/graphql/generate/varString'
import generateCallString   from 'engine/graphql/generate/callString'
import generateOutputString from 'engine/graphql/generate/outputString'

export default function generateQueryUpdate(payload) {
  const { name, fieldList } = payload
  const query = `mutation ${ name }Update(
${ generateVarString({ fieldList }) }
  ) {
      ${ name }Update (
      where: {
${ generateCallString({ fieldList: fieldList.slice(0, 1) }) }
      }
      defaults: {
${ generateCallString({ fieldList: fieldList.slice(1) }) }
      }
  ) {
    result {
      ${ generateOutputString({ name, fieldList }) }
    }
    errors {
      code
      message
    }
  }
}`

  return gql`${ query }`
}
